{"version":3,"sources":["Login.jsx"],"names":["LoginPage","history","useHistory","useProfile","profileData","setProfileData","useState","data","setData","apiError","setApiError","useEffect","name","push","handleChange","value","prev","handleSubmit","e","a","preventDefault","fetch","method","headers","credentials","body","JSON","stringify","cache","referrerPolicy","response","status","json","jsResponse","text","textResponse","className","onSubmit","type","placeholder","onChange","showError","exists","errorContent","content","to"],"mappings":"qOA8FeA,UAtFG,WACd,IAAIC,EAAUC,cACd,EAAsCC,cAA/BC,EAAP,EAAOA,YAAaC,EAApB,EAAoBA,eACpB,EAAwBC,mBAAS,IAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAgCF,mBAAS,CAAC,QAAU,EAAO,QAAW,KAAtE,mBAAOG,EAAP,KAAiBC,EAAjB,KAGAC,qBAAU,WACkB,MAApBP,EAAYQ,MACZX,EAAQY,KAAK,gBAElB,CAACT,IAEJ,IAAMU,EAAe,SAACF,EAAMG,GACxB,OAAQP,GAAQ,SAAAQ,GACZ,OAAO,YAAC,eAAIA,GAAZ,kBAAmBJ,EAAOG,QAI5BE,EAAY,uCAAG,WAAOC,GAAP,mBAAAC,EAAA,6DAEjBD,EAAEE,iBAFe,SAGIC,MAAM,YAAa,CACpCC,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBC,YAAa,UACbC,KAAMC,KAAKC,UAAUpB,GACrBqB,MAAO,WACPC,eAAgB,gBAXH,UAeO,OAZpBC,EAHa,QAeJC,OAfI,iCAgBUD,EAASE,OAhBnB,OAgBTC,EAhBS,OAiBb5B,GAAe,kBAAM4B,KAjBR,2BAkBc,MAApBH,EAASC,OAlBH,kCAmBcD,EAASI,OAnBvB,QAmBPC,EAnBO,OAoBbzB,GAAY,WACJ,MAAO,CAAC,QAAU,EAAM,QAAWyB,MArB9B,wBAyBbzB,GAAY,WACR,MAAO,CAAC,QAAU,EAAM,QAAW,4BA1B1B,4CAAH,sDAgClB,OACI,sBAAK0B,UAAW,YAAhB,UACI,uCACA,uBAAMC,SAAU,SAACnB,GAAD,OAAOD,EAAaC,IAApC,UACI,cAAC,IAAD,CACIN,KAAK,OACL0B,KAAK,OACLC,YAAY,WACZC,SAAU1B,EACVsB,UAAW,aAEf,cAAC,IAAD,CACIxB,KAAK,WACL0B,KAAK,WACLC,YAAY,WACZC,SAAU1B,EACVsB,UAAW,aAEf,yBAAQE,KAAK,SAASvB,MAAM,SAASqB,UAAW,SAAhD,UACI,yBACA,yBACA,yBACA,yBAJJ,eAOJ,cAAC,IAAD,CAAcK,UAAWhC,EAASiC,OAAQC,aAAclC,EAASmC,UACjE,eAAC,IAAD,CAAMC,GAAI,UAAWT,UAAW,UAAhC,UAA2C,yBACvC,yBACA,yBACA,yBAHJ","file":"static/js/7.31a708ef.chunk.js","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\n//Login page css\r\nimport InputField from './InputField'\r\nimport {Link, useHistory} from 'react-router-dom';\r\nimport {useProfile} from \"./ProfileContext\";\r\nimport ErrorDisplay from \"./ErrorDisplay\";\r\nimport \"./Login.css\" ;\r\n\r\nconst LoginPage = () => {\r\n    let history = useHistory();\r\n    const {profileData, setProfileData} = useProfile();\r\n    const [data, setData] = useState({});\r\n    const [apiError, setApiError] = useState({\"exists\": false, \"content\": \"\"});\r\n\r\n    // when profileData is fetched and useState has updated useEffect will trigger\r\n    useEffect(() => {\r\n        if (profileData.name != null) {\r\n            history.push(\"/dashboard\");\r\n        }\r\n    }, [profileData]);\r\n\r\n    const handleChange = (name, value) => {\r\n        return (setData(prev => {\r\n            return ({...prev, [name]: value})\r\n        }))\r\n    }\r\n\r\n    const handleSubmit = async (e) => {\r\n\r\n        e.preventDefault();\r\n        let response = await fetch(\"api/login\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            credentials: \"include\",\r\n            body: JSON.stringify(data),\r\n            cache: 'no-cache',\r\n            referrerPolicy: 'no-referrer',\r\n        });\r\n\r\n        //if login successful\r\n        if (response.status === 200) {\r\n            let jsResponse = await response.json();\r\n            setProfileData(() => jsResponse);\r\n        } else if (response.status === 401) {\r\n            const textResponse = await response.text();\r\n            setApiError(() => {\r\n                    return {\"exists\": true, \"content\": textResponse}\r\n                }\r\n            )\r\n        } else {\r\n            setApiError(() => {\r\n                return {\"exists\": true, \"content\": \"Internal Server Error\"}\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    return (\r\n        <div className={\"login-box\"}>\r\n            <h2>Login</h2>\r\n            <form onSubmit={(e) => handleSubmit(e)}>\r\n                <InputField\r\n                    name=\"name\"\r\n                    type=\"text\"\r\n                    placeholder=\"Username\"\r\n                    onChange={handleChange}\r\n                    className={\"user-box\"}\r\n                />\r\n                <InputField\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    placeholder=\"Password\"\r\n                    onChange={handleChange}\r\n                    className={\"user-box\"}\r\n                />\r\n                <button type=\"submit\" value=\"Submit\" className={\"log-in\"}>\r\n                    <span></span>\r\n                    <span></span>\r\n                    <span></span>\r\n                    <span></span>Log In</button>\r\n\r\n            </form>\r\n            <ErrorDisplay showError={apiError.exists} errorContent={apiError.content}/>\r\n            <Link to={\"/signup\"} className={\"sign-up\"}><span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>Sign Up!</Link>\r\n\r\n        </div>\r\n\r\n    );\r\n}\r\nexport default LoginPage;"],"sourceRoot":""}